{
  "test_01_patch.py::test_no_patches": [
    {
      "cmd": "patch-check",
      "stdout": "\n0 patches needed (0 security patches)\n"
    }
  ],
  "test_01_patch.py::test_rec_patches": [
    {
      "cmd": "patch-check",
      "returncode": 100,
      "stdout": "\nCategory    | Patches\n------------+--------\nrecommended | 3\n\n3 patches needed (0 security patches)\n"
    },
    {
      "cmd": "list-patches",
      "stdout": "\nRepository             | Name               | Category    | Severity | Interactive | Status | Since | Summary\n-----------------------+--------------------+-------------+----------+-------------+--------+-------+----------------------------------\nMain Update Repository | openSUSE-2020-1758 | recommended | moderate | ---         | needed | -     | Recommended update for procps\nMain Update Repository | openSUSE-2020-1760 | recommended | moderate | ---         | needed | -     | Recommended update for chrony\nMain Update Repository | openSUSE-2020-1762 | recommended | moderate | ---         | needed | -     | Recommended update for subversion\n\n3 patches needed (0 security patches)\n\n"
    },
    {
      "cmd": "patch",
      "stdout": "\nThe following 3 NEW patches are going to be installed:\n  openSUSE-2020-1758 openSUSE-2020-1760 openSUSE-2020-1762\n\nThe following 7 packages are going to be upgraded:\n  chrony chrony-pool-openSUSE libprocps7 procps subversion subversion-bash-completion subversion-perl\n\n7 packages to upgrade.\nOverall download size: 4.1 MiB. Already cached: 0 B. After the operation, 4.2 KiB will be freed.\nContinue? [y/n/v/...? shows all options] (y): y\n\n"
    },
    {
      "cmd": "ps"
    }
  ],
  "test_01_patch.py::test_sec_patches": [
    {
      "cmd": "patch-check",
      "returncode": 101,
      "stdout": "\nCategory    | Patches\n------------+--------\nsecurity    | 2\nrecommended | 1\n\n3 patches needed (2 security patches)\n"
    },
    {
      "cmd": "list-patches",
      "stdout": "\nRepository             | Name               | Category    | Severity  | Interactive | Status | Since | Summary\n-----------------------+--------------------+-------------+-----------+-------------+--------+-------+-------------------------------------\nMain Update Repository | openSUSE-2020-1743 | security    | moderate  | ---         | needed | -     | Security update for gnutls\nMain Update Repository | openSUSE-2020-1744 | security    | important | ---         | needed | -     | Security update for freetype2\nMain Update Repository | openSUSE-2020-1745 | recommended | moderate  | ---         | needed | -     | Recommended update for yast2-network\n\n3 patches needed (2 security patches)\n\n"
    },
    {
      "cmd": "patch",
      "stdout": "\nThe following 3 NEW patches are going to be installed:\n  openSUSE-2020-1743 openSUSE-2020-1744 openSUSE-2020-1745\n\nThe following 15 packages are going to be upgraded:\n  ft2demos ftbench ftdiff ftdump ftgamma ftgrid ftinspect ftlint ftmulti ftstring ftvalid ftview libfreetype6 libgnutls30 yast2-network\n\n15 packages to upgrade.\nOverall download size: 2.2 MiB. Already cached: 0 B. After the operation, additional 21.6 KiB will be used.\nContinue? [y/n/v/...? shows all options] (y): y\n\n"
    },
    {
      "cmd": "ps"
    }
  ],
  "test_01_patch.py::test_zypp_patches": [
    {
      "cmd": "patch-check",
      "returncode": 101,
      "stdout": "\nCategory    | Updatestack | Patches\n------------+-------------+--------\nsecurity    | -           | 2\nrecommended | 1           | 2\n\n5 patches needed (2 security patches)\n"
    },
    {
      "cmd": "list-patches",
      "stdout": "\nRepository             | Name               | Category    | Severity | Interactive | Status | Since | Summary\n-----------------------+--------------------+-------------+----------+-------------+--------+-------+---------------------------------------\nMain Update Repository | openSUSE-2020-1615 | recommended | moderate | restart     | needed | -     | Recommended update for libzypp, zypper\n\nRepository             | Name               | Category    | Severity  | Interactive | Status | Since | Summary\n-----------------------+--------------------+-------------+-----------+-------------+--------+-------+-------------------------------\nMain Update Repository | openSUSE-2020-1597 | recommended | moderate  | ---         | needed | -     | Recommended update for openssh\nMain Update Repository | openSUSE-2020-1598 | security    | moderate  | ---         | needed | -     | Security update for python-pip\nMain Update Repository | openSUSE-2020-1606 | recommended | moderate  | ---         | needed | -     | Recommended update for rsyslog\nMain Update Repository | openSUSE-2020-1608 | security    | important | ---         | needed | -     | Security update for xen\n\n5 patches needed (2 security patches)\n\n"
    },
    {
      "cmd": "patch",
      "returncode": 103,
      "stdout": "\nThe following NEW patch is going to be installed:\n  openSUSE-2020-1615\n\nThe following 4 packages are going to be upgraded:\n  libzypp zypper zypper-log zypper-needs-restarting\n\n4 packages to upgrade.\nOverall download size: 3.8 MiB. Already cached: 0 B. After the operation, additional 53.5 KiB will be used.\n\nContinue? [y/n/v/...? shows all options] (y): y\n\nWarning: One of the installed patches affects the package manager itself. Run this command once more to install any other needed patches.\n"
    },
    {
      "cmd": "patch-check",
      "returncode": 101,
      "stdout": "\nCategory    | Patches\n------------+--------\nsecurity    | 2\nrecommended | 2\n\n4 patches needed (2 security patches)\n"
    },
    {
      "cmd": "list-patches",
      "stdout": "\nRepository             | Name               | Category    | Severity  | Interactive | Status | Since | Summary\n-----------------------+--------------------+-------------+-----------+-------------+--------+-------+-------------------------------\nMain Update Repository | openSUSE-2020-1597 | recommended | moderate  | ---         | needed | -     | Recommended update for openssh\nMain Update Repository | openSUSE-2020-1598 | security    | moderate  | ---         | needed | -     | Security update for python-pip\nMain Update Repository | openSUSE-2020-1606 | recommended | moderate  | ---         | needed | -     | Recommended update for rsyslog\nMain Update Repository | openSUSE-2020-1608 | security    | important | ---         | needed | -     | Security update for xen\n\n4 patches needed (2 security patches)\n\n"
    },
    {
      "cmd": "patch",
      "stdout": "\nThe following 4 NEW patches are going to be installed:\n  openSUSE-2020-1597 openSUSE-2020-1598 openSUSE-2020-1606 openSUSE-2020-1608\n\nThe following 6 packages are going to be upgraded:\n  openssh openssh-askpass-gnome openssh-helpers python3-pip rsyslog xen-libs\n\n6 packages to upgrade.\nOverall download size: 4.1 MiB. Already cached: 0 B. After the operation, additional 6.0 KiB will be used.\nContinue? [y/n/v/...? shows all options] (y): y\n\n"
    },
    {
      "cmd": "ps"
    }
  ],
  "test_01_patch.py::test_patch_psproc": [
    {
      "cmd": "patch-check",
      "returncode": 101,
      "stdout": "\nCategory | Patches\n---------+--------\nsecurity | 1\n\n1 patch needed (1 security patch)\n"
    },
    {
      "cmd": "list-patches",
      "stdout": "\nRepository             | Name               | Category | Severity | Interactive | Status | Since | Summary\n-----------------------+--------------------+----------+----------+-------------+--------+-------+---------------------------------------\nMain Update Repository | openSUSE-2020-1693 | security | moderate | ---         | needed | -     | Security update for gcc10, nvptx-tools\n\n1 patch needed (1 security patch)\n\n"
    },
    {
      "cmd": "patch",
      "stdout": "\nThe following NEW patch is going to be installed:\n  openSUSE-2020-1693\n\nThe following 2 packages are going to be upgraded:\n  libgcc_s1 libstdc++6\n\n2 packages to upgrade.\nOverall download size: 528.0 KiB. Already cached: 0 B. After the operation, 23.8 KiB will be freed.\nContinue? [y/n/v/...? shows all options] (y): y\n\n"
    },
    {
      "cmd": "ps",
      "stdout": "\nPID   | PPID | UID | User    | Command  | Service                                        | Files\n------+------+-----+---------+----------+------------------------------------------------+-------------------------------\n871   | 1    | 0   | root    | qemu-ga  | qemu-ga@virtio\\x2dports-org.qemu.guest_agent.0 | /lib64/libgcc_s.so.1\n1364  | 1    | 480 | polkitd | polkitd  | polkit                                         | /usr/lib64/libstdc++.so.6.0.28\n      |      |     |         |          |                                                | /lib64/libgcc_s.so.1\n4503  | 1    | 0   | root    | master   | postfix                                        | /usr/lib64/libstdc++.so.6.0.28\n      |      |     |         |          |                                                | /lib64/libgcc_s.so.1\n4506  | 4503 | 51  | postfix | qmgr     | postfix                                        | /usr/lib64/libstdc++.so.6.0.28\n      |      |     |         |          |                                                | /lib64/libgcc_s.so.1\n6748  | 4503 | 51  | postfix | pickup   | postfix                                        | /usr/lib64/libstdc++.so.6.0.28\n      |      |     |         |          |                                                | /lib64/libgcc_s.so.1\n10185 | 1    | 0   | root    | snapperd | dbus                                           | /usr/lib64/libstdc++.so.6.0.28\n      |      |     |         |          |                                                | /lib64/libgcc_s.so.1\n10852 | 4503 | 51  | postfix | tlsmgr   | postfix                                        | /usr/lib64/libstdc++.so.6.0.28\n      |      |     |         |          |                                                | /lib64/libgcc_s.so.1\n\n"
    }
  ],
  "test_01_patch.py::test_patch_psreboot": [
    {
      "cmd": "patch-check",
      "returncode": 100,
      "stdout": "\nCategory    | Patches\n------------+--------\nrecommended | 2\n\n2 patches needed (0 security patches)\n"
    },
    {
      "cmd": "list-patches",
      "stdout": "\nRepository             | Name               | Category    | Severity  | Interactive | Status | Since | Summary\n-----------------------+--------------------+-------------+-----------+-------------+--------+-------+---------------------------------------\nMain Update Repository | openSUSE-2020-1672 | recommended | moderate  | ---         | needed | -     | Recommended update for openssl-1_1\nMain Update Repository | openSUSE-2020-1673 | recommended | important | ---         | needed | -     | Recommended update for multipath-tools\n\n2 patches needed (0 security patches)\n\n"
    },
    {
      "cmd": "patch",
      "stdout": "\nThe following 2 NEW patches are going to be installed:\n  openSUSE-2020-1672 openSUSE-2020-1673\n\nThe following 4 packages are going to be upgraded:\n  kpartx libopenssl1_1 multipath-tools openssl-1_1\n\nThe following package requires a system reboot:\n  libopenssl1_1\n\n4 packages to upgrade.\nOverall download size: 2.4 MiB. Already cached: 0 B. After the operation, additional 5.2 KiB will be used.\n\nContinue? [y/n/v/...? shows all options] (y): y\n\n"
    },
    {
      "cmd": "ps",
      "returncode": 102,
      "stdout": "\nPID   | PPID  | UID | User    | Command     | Service    | Files\n------+-------+-----+---------+-------------+------------+----------------------------\n937   | 1     | 0   | root    | python3.6   | firewalld  | /usr/lib64/libcrypto.so.1.1\n      |       |     |         |             |            | /usr/lib64/libssl.so.1.1\n938   | 1     | 0   | root    | sssd        | sssd       | /usr/lib64/libcrypto.so.1.1\n1084  | 938   | 0   | root    | sssd_be     | sssd       | /usr/lib64/libcrypto.so.1.1\n      |       |     |         |             |            | /usr/lib64/libssl.so.1.1\n1089  | 938   | 0   | root    | sssd_nss    | sssd       | /usr/lib64/libcrypto.so.1.1\n1090  | 938   | 0   | root    | sssd_pam    | sssd       | /usr/lib64/libcrypto.so.1.1\n1091  | 938   | 0   | root    | sssd_autofs | sssd       | /usr/lib64/libcrypto.so.1.1\n1840  | 1     | 0   | root    | sshd        | sshd       | /usr/lib64/libcrypto.so.1.1\n1886  | 1     | 44  | named   | named       | named      | /usr/lib64/libcrypto.so.1.1\n      |       |     |         |             |            | /usr/lib64/libssl.so.1.1\n1899  | 1     | 76  | ldap    | slapd       | slapd      | /usr/lib64/libcrypto.so.1.1\n      |       |     |         |             |            | /usr/lib64/libssl.so.1.1\n1921  | 1     | 0   | root    | automount   | autofs     | /usr/lib64/libssl.so.1.1\n      |       |     |         |             |            | /usr/lib64/libcrypto.so.1.1\n12235 | 1     | 0   | root    | python3.6   | auto-patch | /usr/lib64/libcrypto.so.1.1\n      |       |     |         |             |            | /usr/lib64/libssl.so.1.1\n14443 | 14413 | 51  | postfix | tlsmgr      | postfix    | /usr/lib64/libcrypto.so.1.1\n      |       |     |         |             |            | /usr/lib64/libssl.so.1.1\n\n"
    }
  ]
}
